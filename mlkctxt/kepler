#!/bin/bash

# ---------------------------
#
# Common settings for all contexts, base for development.
#
# ---------------------------
#
# Prefix variables with MLKC_CELL_RAW_DATA_.
#
# ---------------------------
export MLKC_CELL_RAW_DATA_INSTANCE_NAME=kepler
export MLKC_CELL_RAW_DATA_VERSION=1.0.0
export MLKC_CELL_RAW_DATA_INSTANCE_GENERATION=$(date +"%Y%m%d-%H%M%S")

# -----
# SSH access
# -----
export MLKC_CELL_RAW_DATA_SSH_HOST=$MLKC_SYSTEM_KEPLER_HOST
export MLKC_CELL_RAW_DATA_SSH_USER=$MLKC_SYSTEM_KEPLER_USER
export MLKC_CELL_RAW_DATA_REMOTE_FOLDER=$MLKC_SYSTEM_KEPLER_USER@$MLKC_SYSTEM_KEPLER_HOST:/home/apps/cell_raw_data

# -----
# PostGIS for local deployment
# -----
export MLKC_CELL_RAW_DATA_PG_PORT=5643

# User postgres
export MLKC_CELL_RAW_DATA_PG_PASS=$MLKC_SYSTEM_KEPLER_PG_PASS

# User cell_master
export MLKC_CELL_RAW_DATA_PG_CELL_MASTER_PASS=$MLKC_SYSTEM_KEPLER_PG_PASS_CELL_MASTER

# User cell_readonly
export MLKC_CELL_RAW_DATA_PG_CELL_READONLY_PASS=$MLKC_SYSTEM_KEPLER_PG_PASS_CELL_READONLY

# User nacional for the proyecto_nacional DB
export MLKC_CELL_RAW_DATA_PG_NACIONAL_PASS=$MLKC_SYSTEM_KEPLER_PG_PASS_NACIONAL

# -----
# PG Config for 64GB RAM, 8 CPU, SSD
# This is for PG configuration file, not for the pool
# -----
export MLKC_CELL_RAW_DATA_PG_MAX_CONNECTIONS=200
export MLKC_CELL_RAW_DATA_PG_SHARED_BUFFERS=40GB
export MLKC_CELL_RAW_DATA_PG_EFFECTIVE_CACHE_SIZE=122GB
export MLKC_CELL_RAW_DATA_PG_MAINTENANCE_WORK_MEM=2GB
export MLKC_CELL_RAW_DATA_PG_CHECKPOINT_COMPLETION_TARGET=0.7
export MLKC_CELL_RAW_DATA_PG_WAL_BUFFERS=16MB
export MLKC_CELL_RAW_DATA_PG_DEFAULT_STATISTICS_TARGET=500
export MLKC_CELL_RAW_DATA_PG_RANDOM_PAGE_COST=1.1
export MLKC_CELL_RAW_DATA_PG_EFFECTIVE_IO_CONCURRENCY=200
export MLKC_CELL_RAW_DATA_PG_WORK_MEM=332MB
export MLKC_CELL_RAW_DATA_PG_MIN_WAL_SIZE=512MB
export MLKC_CELL_RAW_DATA_PG_MAX_WAL_SIZE=2GB
export MLKC_CELL_RAW_DATA_PG_MAX_WORKER_PROCESSES=8
export MLKC_CELL_RAW_DATA_PG_MAX_PARALLEL_WORKERS_PER_GATHER=4
export MLKC_CELL_RAW_DATA_PG_MAX_PARALLEL_WORKERS=8
export MLKC_CELL_RAW_DATA_PG_MAX_PARALLEL_MAINTENANCE_WORKERS=4
